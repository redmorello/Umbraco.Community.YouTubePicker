{"version":3,"file":"propertyeditor.element-BJMvN_sF.js","sources":["../../../Client/src/propertyeditors/modal-token.ts","../../../Client/src/utils/parse-boolean.function.ts","../../../Client/src/utils/parse-int.function.ts","../../../Client/src/propertyeditors/propertyeditor.element.ts"],"sourcesContent":["import { UmbModalToken } from \"@umbraco-cms/backoffice/modal\";\r\nimport {YouTubeItem} from \"../api\";\r\n\r\nexport interface SidebarData {\r\n  headline: string;\r\n  apiKey:string;\r\n  channelId:string;\r\n  perPage:number;\r\n}\r\n\r\nexport interface SidebarValue {\r\n  value: YouTubeItem;\r\n}\r\n\r\nexport const MODAL_TOKEN = new UmbModalToken<SidebarData, SidebarValue>('youtube-picker-modal', {\r\n  modal: {\r\n    type: 'custom',\r\n    size:'medium'\r\n  }\r\n});\r\n","export function parseBoolean(value: unknown): boolean {\n  if (value === '0') return false;\n  if (typeof value === 'string' && value.toLowerCase() === 'false') return false;\n  return Boolean(value);\n}\n","export function parseInt(input: unknown): number | undefined {\n  const num = Number(input);\n  return Number.isNaN(num) ? undefined : num;\n}\n","import { css, html, LitElement, customElement, property, state } from \"@umbraco-cms/backoffice/external/lit\";\r\nimport { UUIButtonElement } from \"@umbraco-cms/backoffice/external/uui\";\r\nimport { type UmbPropertyEditorConfigCollection } from '@umbraco-cms/backoffice/property-editor';\r\nimport { UMB_MODAL_MANAGER_CONTEXT } from '@umbraco-cms/backoffice/modal';\r\nimport { MODAL_TOKEN } from './modal-token.js';\r\nimport { UmbChangeEvent } from '@umbraco-cms/backoffice/event';\r\nimport { parseBoolean, parseInt } from '../utils';\r\nimport {YouTubeItem} from \"../api\";\r\nimport { UmbElementMixin } from '@umbraco-cms/backoffice/element-api';\r\n\r\n@customElement('youtube-picker-property-editor-ui')\r\nexport default class YoutubePickerElement extends UmbElementMixin(LitElement) {\r\n\r\n  @property({ type: String })\r\n  public value = '';\r\n\r\n  //@state()\r\n  //private _selectedItem?: YouTubeItem;\r\n\r\n  @state()\r\n  private _apiKey?: string;\r\n\r\n  @state()\r\n  private _channelId?: string;\r\n\r\n  @state()\r\n  private _perPage?: number;\r\n\r\n  //@state()\r\n  //private _alloweditors?: boolean;\r\n\r\n  @state()\r\n  private _nocookie?: boolean;\r\n\r\n  @state()\r\n  private _rel?: boolean;\r\n\r\n  @state()\r\n  private _modestbranding?: boolean;\r\n\r\n  @state()\r\n  private _autoplay?: boolean;\r\n\r\n  @state()\r\n  private _fs?: boolean;\r\n\r\n  @state()\r\n  private _error?: string;\r\n\r\n  @state()\r\n  private _hasError?: boolean = false;\r\n\r\n  @property({ attribute: false })\r\n  public set config(config: UmbPropertyEditorConfigCollection) {\r\n    if (!config) return;\r\n\r\n    this._apiKey = config.getValueByAlias('apiKey');\r\n    this._channelId = config.getValueByAlias('channelId');\r\n    this._perPage = parseInt(config.getValueByAlias('perPage')) || 50;\r\n    //this._alloweditors = parseBoolean(config.getValueByAlias('alloweditors')) || false;\r\n    this._nocookie = parseBoolean(config.getValueByAlias('nocookie')) || false;\r\n    this._rel = parseBoolean(config.getValueByAlias('rel')) || false;\r\n    this._modestbranding = parseBoolean(config.getValueByAlias('modestbranding')) || false;\r\n    this._autoplay = parseBoolean(config.getValueByAlias('autoplay')) || false;\r\n    this._fs = parseBoolean(config.getValueByAlias('fs')) || false;\r\n\r\n    if(this._perPage > 50)\r\n    {\r\n      this._perPage = 50\r\n    }\r\n\r\n    if(this._apiKey === undefined || this._apiKey === null || this._apiKey === \"\")\r\n    {\r\n      this._hasError = true;\r\n      this._error = \"API key is required\";\r\n    }\r\n  }\r\n\r\n  #modalManagerContext?: typeof UMB_MODAL_MANAGER_CONTEXT.TYPE;\r\n\r\n  constructor() {\r\n    super();\r\n    this.consumeContext(UMB_MODAL_MANAGER_CONTEXT, (instance) => {\r\n      this.#modalManagerContext = instance;\r\n      // modalManagerContext is now ready to be used.\r\n    });\r\n  }\r\n\r\n  private _handleSubmit(isPositive?: boolean, data?: YouTubeItem) {\r\n    if(isPositive)\r\n    {\r\n      let url = this._nocookie === true ? \"https://www.youtube-nocookie.com/embed/\" : \"https://www.youtube.com/embed/\";\r\n\r\n      if (data?.id.kind === 'youtube#video') {\r\n        url += data.id?.videoId;\r\n      } else if (data?.id.kind === 'youtube#playlist') {\r\n        url += 'videoseries?list=' + data.id.playlistId;\r\n      }\r\n\r\n      const playerUrl = new URL(url);\r\n      playerUrl.searchParams.set('rel', this._rel === true ? '1' : '0');\r\n      playerUrl.searchParams.set('modestbranding', this._modestbranding === true ? '1' : '0');\r\n      playerUrl.searchParams.set('autoplay', this._autoplay === true ? '1' : '0');\r\n      playerUrl.searchParams.set('fs', this._fs === true ? '1' : '0');\r\n      this.value = playerUrl.toString();\r\n\r\n      //console.log(\"Player url: \" + this.value);\r\n    }else{\r\n      //console.log(\"Cancelled\");\r\n    }\r\n  }\r\n\r\n  #onClickVideoDelete = async (ev: Event) => {\r\n    const buttonElement = ev.target as UUIButtonElement;\r\n    buttonElement.state = \"waiting\";\r\n    this.value = \"\";\r\n    buttonElement.state = \"success\";\r\n    this.dispatchEvent(new UmbChangeEvent());\r\n  }\r\n\r\n  #onClickSelectVideo = async (ev: Event) => {\r\n    const buttonElement = ev.target as UUIButtonElement;\r\n    buttonElement.state = \"waiting\";\r\n\r\n    const ctx = this.#modalManagerContext?.open(this, MODAL_TOKEN,\r\n      {\r\n        data: {\r\n          headline: 'Choose a video or playlist',\r\n          apiKey: this._apiKey || \"\",\r\n          channelId: this._channelId || \"\",\r\n          perPage: this._perPage || 50\r\n        }\r\n      });\r\n\r\n    ctx\r\n      ?.onSubmit()\r\n      .then((value) => {\r\n        //console.log(\"Submitted\", value);\r\n        this._handleSubmit(true, value.value as YouTubeItem);\r\n        this.dispatchEvent(new UmbChangeEvent());\r\n      })\r\n      .catch(() => {\r\n        this._handleSubmit(false);\r\n      });\r\n\r\n    buttonElement.state = \"success\";\r\n  }\r\n\r\n  render() {\r\n    return html`\r\n        ${this.value != \"\" && this.value != null && this.value != undefined\r\n      ? html`<div id=\"video-wrapper\">\r\n          <div class=\"embed-responsive embed-responsive-16by9\">\r\n            <iframe\r\n              style=\"width: 25rem; height: 15rem\"\r\n              src=\"${this.value}\"\r\n              title=\"YouTube video player\"\r\n              allow=\"accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture\"\r\n              allowfullscreen>\r\n            </iframe>\r\n          </div>\r\n\r\n          <uui-button @click=\"${this.#onClickVideoDelete}\"\r\n            id=\"video-delete\"\r\n            class=\"element\"\r\n            color=\"warning\" look=\"primary\"\r\n            label=\"Delete\"\r\n          >\r\n            Delete\r\n          </uui-button>\r\n        </div>`\r\n      : html`<div id=\"wrapper\">\r\n            ${!this._hasError ? html`\r\n                <uui-button @click=\"${this.#onClickSelectVideo}\"\r\n                  id=\"video-overlay\"\r\n                  class=\"element\"\r\n                  look=\"primary\"\r\n                  label=\"Select video\"\r\n                >\r\n                  Select video\r\n                </uui-button>`\r\n            : html`<p>${this._error}</p>`}\r\n              </div>`}\r\n    `;\r\n  }\r\n\r\n  static styles = [\r\n    css`\r\n            :host {\r\n                display: grid;\r\n                gap: var(--uui-size-layout-1);\r\n                grid-template-columns: 1fr 1fr 1fr;\r\n            }\r\n\r\n            uui-box {\r\n                margin-bottom: var(--uui-size-layout-1);\r\n            }\r\n\r\n            h2 {\r\n                margin-top:0;\r\n            }\r\n\r\n            .wide {\r\n                grid-column: span 3;\r\n            }\r\n    `];\r\n}\r\n\r\ndeclare global {\r\n  interface HTMLElementTagNameMap {\r\n    'youtube-picker-property-editor-ui': YoutubePickerElement;\r\n  }\r\n}\r\n"],"names":["MODAL_TOKEN","UmbModalToken","parseBoolean","value","parseInt","input","num","_modalManagerContext","_onClickVideoDelete","_onClickSelectVideo","YoutubePickerElement","UmbElementMixin","LitElement","__privateAdd","ev","buttonElement","UmbChangeEvent","ctx","_a","__privateGet","UMB_MODAL_MANAGER_CONTEXT","instance","__privateSet","config","isPositive","data","url","playerUrl","html","css","__decorateClass","property","state","customElement"],"mappings":"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"}